<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Healthify Diagnostics</title>
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-video-container">
            <video autoplay muted loop playsinline class="hero-video">
                <source src="/videos/hero-video.mp4" type="video/mp4">
                <p>Your browser does not support the video tag. <a href="/images/hero-fallback.jpg">View fallback image</a>.</p>
            </video>
            <div class="hero-content">
                <h1>Welcome to Healthify Diagnostics</h1>
                <p>Comprehensive health checkups at your fingertips.</p>
                <a href="#book-now" class="cta-button">Book Now</a>
            </div>
        </div>
    </section>

    <!-- Promo Profiles (Swipable Cards) -->
    <section class="promo-profiles">
        <h2>Featured Health Packages</h2>
        <div class="swiper promo-swiper">
            <div class="swiper-wrapper" id="promoSlides">
                <!-- Populated by search.js -->
            </div>
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
            <div class="swiper-pagination"></div>
        </div>
    </section>

    <!-- Featured Profiles (Swipable Cards) -->
    <section class="featured-profiles">
        <h2>Popular Individual Tests</h2>
        <div class="swiper featured-swiper">
            <div class="swiper-wrapper" id="featuredSlides">
                <!-- Populated by search.js -->
            </div>
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
            <div class="swiper-pagination"></div>
        </div>
    </section>

    <!-- Search and Booking Section -->
    <section class="search-section" id="book-now">
        <input type="text" id="searchInput" placeholder="Search for tests or profiles...">
        <div id="searchResults"></div>
        <div id="summaryCard" style="display: none;">
            <h3>Selected Tests</h3>
            <ul id="selectedTests"></ul>
            <button id="bookNowBtn">Book Now</button>
        </div>
        <div id="errorMessage" style="display: none;"></div>
    </section>

    <!-- Scripts -->
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script src="/search.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Swipers
            const promoSwiper = new Swiper('.promo-swiper', {
                slidesPerView: 3,
                spaceBetween: 20,
                loop: true,
                autoplay: { delay: 3000, disableOnInteraction: false },
                navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
                pagination: { el: '.swiper-pagination', clickable: true },
                breakpoints: {
                    320: { slidesPerView: 1 },
                    768: { slidesPerView: 2 },
                    1024: { slidesPerView: 3 }
                }
            });

            const featuredSwiper = new Swiper('.featured-swiper', {
                slidesPerView: 3,
                spaceBetween: 20,
                loop: true,
                autoplay: { delay: 3000, disableOnInteraction: false },
                navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
                pagination: { el: '.swiper-pagination', clickable: true },
                breakpoints: {
                    320: { slidesPerView: 1 },
                    768: { slidesPerView: 2 },
                    1024: { slidesPerView: 3 }
                }
            });

            // Fetch and populate slides
            fetch('/public/tests.json')
                .then(response => response.json())
                .then(tests => {
                    const promoSlides = tests.filter(test => test.Category === "Health Checkup Profiles").slice(0, 6);
                    const featuredSlides = tests.filter(test => test.Category === "Individual Tests").slice(0, 6);
                    populateSlides('promoSlides', promoSlides);
                    populateSlides('featuredSlides', featuredSlides);
                    promoSwiper.update();
                    featuredSwiper.update();
                })
                .catch(error => {
                    document.getElementById('errorMessage').innerText = 'Error loading tests: ' + error;
                    document.getElementById('errorMessage').style.display = 'block';
                });
        });

        function populateSlides(id, tests) {
            const wrapper = document.getElementById(id);
            wrapper.innerHTML = '';
            tests.forEach(test => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                slide.innerHTML = `<div class="card"><h3>${test.Test_Name}</h3><p>${test.Description}</p><p>â‚¹${test.Healthify_Offer_Price}</p></div>`;
                wrapper.appendChild(slide);
            });
        }
    </script>
</body>
</html>
